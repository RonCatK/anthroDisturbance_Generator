calculateLineAngle <- function(Line) {
  coords <- terra::crds(Line)
  # If fewer than 2 coordinates, return NA to avoid subscript errors
  if (is.null(coords) || nrow(coords) < 2) {
    return(NA_real_)
  }
  delta_y <- coords[2, 2] - coords[1, 2]
  delta_x <- coords[2, 1] - coords[1, 1]
  angle <- atan2(delta_y, delta_x) * 180 / pi
  return(angle)
}